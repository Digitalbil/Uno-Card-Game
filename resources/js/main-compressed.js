var lastUpdateId=0;var lock=false;var update=function(){jQuery.getJSON("update.php?updateId="+lastUpdateId,{},updateCallback)};var updateCallback=function(b,c,a){toggleLoadingSpinner(false);lock=false;if(typeof b.error!="undefined"){showError(b.error)}if(b.update==true){lastUpdateId=b.updateId;$("#front").html(b.html.front);$("#cards").html(b.html.playerCards);$("#players").html(b.html.players);updateActions();updateNoSelects()}};var updateActions=function(){$(".action").not('[rel^="?null"]').not(".action-activated").each(function(){$(this).addClass("not-null").addClass("action-activated").click(function(){doAction($(this).attr("rel"))})})};var doAction=function(a){if(lock==false){toggleLoadingSpinner(true);lock=true;jQuery.getJSON("sendUpdate.php"+a,{},updateCallback)}};var toggleLoadingSpinner=function(a){if(a==true){$("#loading").show().spin({lines:12,length:7,width:4,radius:10,color:"#000",speed:1,trail:60,shadow:false})}else{$("#loading").hide().spin(false)}};var showError=function(a){$("#error #message").html(a);$("#error").show().animate({opacity:1},300);$("#error_overlay").show().animate({opacity:0.3},300)};var updateNoSelects=function(){$(".no-select").not(".no-select-activated").addClass("no-select-activated").mousedown(function(){return false})};$(function(){if(!$("body").hasClass("no-game")){update()}updateNoSelects();$(".no-game #join-game button, .game #join-game").click(function(){var a=prompt("Invite ID","");$.ajax({url:"sendUpdate.php?action=joinGame&id="+a,success:function(){window.location.reload()}})});$(".no-game #create-game button, .game #create-game").click(function(){$.ajax({url:"sendUpdate.php?action=createGame",success:function(){window.location.reload()}})});$("#error button").click(function(){$("#error, #error_overlay").css({opacity:0,display:"none"})});setInterval(update,1000)});